---
title: 'Paper review: Geodesics of Stiefel Manifold (III)'
date: 2025-09-13
permalink: /posts/2025/09/blog-post-13/
tags:
  - manifold optimization
  - geometry
excerpt: "Continue on from the [last paper review](/posts/2025/08/blog-post-10/), let me continue down analyzing the work by Edelman. This post is about the parallel transport."
---

Let us continue on reviewing the paper "[The Geoemtry of Algorithms with Orthogonality Constraints](https://arxiv.org/abs/physics/9806030)" by Edelman et al.

In terms of the intrinsic local coordinates of a manifold, one can express the geodesic equation of a curve \\(x(t)\in\mathcal{M}\\) as
<p>

$$
\ddot{x}^{k} + \Gamma_{ij}^{k} \dot{x}^{i} \dot{x}^{j} = 0,
$$
</p>
where \\(x^i\\) is the \\(i\\)th coordinate of \\(x\\), \\(\Gamma _{ij}^{k}\\) is the *Christoffel symbol*, and the Einstein summation convention is used.

In the study of matrix manifolds, however, we like to express things extrinsically as the manifold is embedded in a larger Euclidean space (the metric can be other than Euclidean though). So for a curve \\(X(t)\\) over a matrix manifold \\(\mathcal{M}\\), the geodesic equation can be written in the form of
<p>

$$
\ddot{X} + \Gamma(\dot{X},\dot{X}) = 0.
$$
</p>

One can then immediately interpret the effect of the Christoffel symbols as removing the "normal" components.

# Parallel transport
When parallel transporting a vector \\(K _0 \in T _{X _0}\mathcal{M}\\) over a geodesic \\(X(t)\\) with initial velocity \\(H _0 \in T _{X _0}\mathcal{M}\\), a procedure one can take is to iteratively remove the normal component to \\(K(t)\\) as it is moving along \\(X(t)\\).

## Intrinsic viewpoint
We again start our discussion from the intrinsic viewpoint well established in differential geometry. For the vector \\(K _0\\) to be parallel transported, we require that it is *parallel* along \\(\dot{X}\\). I.e., we have that \\(K(t)\\), the parallel transport of \\(K _0\\) as time \\(t\\) varies, must satisfy the differential equation
<p>

$$
\nabla_{\dot{X}}K = 0.
$$
</p>

Expanding using the intrinsic local coordinates, let the coordinates of \\(K\\) be \\\(y^i\\). Then, one has the relation
<p>

$$
\dot{y}^k + \Gamma_{ij}^k \dot{x}^i \dot{y}^j = 0.
$$
</p>
This suggest the extrinsic form to the parallel transport equation to be
<p>

$$
\boxed{
    \dot{K} + \Gamma(K,\dot{X}) = 0
},
$$
</p>
where the bilinear form \\(\Gamma(K,\dot{X})\\) is induced from the symmetric form \\(\Gamma(\dot{X},\dot{X})\\) point-wise. Let us verify the above from an extrinsic point of view. (I will not check the smoothness as I am an engineer.)

## Extrinsic viewpoint
Consider the manifold being embedded in an external space. Using the same arguments as in the [first post](/posts/2025/08/blog-post-4/), we have
<p>

$$
\begin{align*}
    &\nabla_{\dot{X}}K = \left(\dot{K}\right)_{\mathrm{tangent}} = 0, \\
    &\Rightarrow \dot{K} \in (T_X\mathcal{M})^\perp.
\end{align*}
$$
</p>

What is the form of the normal component, then, that we need to remove?

Consider time going from \\(t=0\\) to \\(t=\varepsilon\\), the point \\(X(t)\\) moves from \\(X(0) = X _0\\) to \\(X(\varepsilon)\\). Then, by directly moving \\(K _0\\) from \\(X _0\\) to \\(X(\varepsilon)\\), it is required that we remove the normal component to \\(K _0\\) so that the transported vector remains on the tangent space. The normal component is
<p>

$$
\Pi^\perp_{X(\varepsilon)}(K_0).
$$
</p>
This is the projection onto the normal space. Thus,
<p>

$$
\begin{aligned}
    K(\varepsilon) &= K_0 - \Pi^\perp_{X(\varepsilon)}(K_0), \\
    \Rightarrow \dot{K}(0) &= \lim_{\varepsilon \rightarrow 0} \frac{K(\varepsilon) - K_0}{\varepsilon} \\
    &= -\lim_{\varepsilon \rightarrow 0} \frac{1}{\varepsilon} \cdot \Pi^\perp_{X(\varepsilon)}(K_0) \\
    &= -\lim_{\varepsilon \rightarrow 0} \frac{1}{\varepsilon} \cdot \left(K_0 - \Pi_{X(\varepsilon)}(K_0)\right) \\
    &= \lim_{\varepsilon \rightarrow 0} \frac{1}{\varepsilon} \cdot \left(\Pi_{X(\varepsilon)}(K_0) - \Pi_{X_0}(K_0)\right), \\
    \Rightarrow \dot{K}(t) &= \lim_{\varepsilon \rightarrow 0} \frac{1}{\varepsilon} \left(\Pi_{X(t+\varepsilon)}(K(t)) - \Pi_{X(t)}(K(t))\right) \\
    &= \left.\frac{\mathrm{d}}{\mathrm{d}s}\right|_{s=t} \Pi_{X(s)}(K(t)).
\end{aligned}
$$
</p>
We thus have the parallel transform equation
<p>

$$
\boxed{
    \dot{K}(t) - \left.\frac{\mathrm{d}}{\mathrm{d}s}\right|_{s=t} \Pi_{X(s)}(K(t)) = 0
}.
$$
</p>
The function \\(X(t)\\) is the geodesic, and the \\(X, K\\) without \\(t\\) behind it are constants evaluated at \\(t=0\\) (they are the initial conditions).

## Comparing the two viewpoints...
Comparing the two viewpoints, we see that
<p>

$$
\boxed{
    \Gamma(\dot{X}(t),K(t)) = - \left.\frac{\mathrm{d}}{\mathrm{d}s}\right|_{s=t} \Pi_{X(s)}(K(t))
}.
$$
</p>

Consider the Stiefel manifold \\(\mathrm{St}(m,k)\\) as an example, we have
<p>

$$
\Pi_{X}(K) = K - X \cdot \mathrm{sym}(X^\mathsf{T} K).
$$
</p>
From the arguments given by Edelman, we also have
<p>

$$
\Gamma(\dot{X},K) = X \cdot \mathrm{sym}(\dot{X}^\mathsf{T} K).
$$
</p>
The validity of the boxed equation can be immediately seen.


# If the geodesic equation is solved...
In the [second paper review](/posts/2025/08/blog-post-10/), I introduced the formula for the parallel transport \\(\tau\\) given the geodesic \\(\gamma\\) as
<p>

$$
\boxed{
    K(t) \equiv \tau_{\gamma_{X_0,H_0}(t)}[K_0] = \left.\frac{\mathrm{d}}{\mathrm{d}s}\right|_{s=0}\gamma_{X_0,H_0+sK_0}(t)
}.
$$
</p>
The parallel transport map is \\(\tau _{\gamma _{X _0,H _0}(t)}: T _{X _0}\mathcal{M} \rightarrow T _{\gamma _{X _0,H _0}(t)}\mathcal{M}\\).

The immediate question will be asking whether the two parallel transport equations compatible?

They indeed are, and the proof is as below:
<p>

$$
\begin{aligned}
    \dot{K}(t) &= - \left.\frac{\mathrm{d}}{\mathrm{d}s}\right|_{s=t} \Pi_{X(s)}(K(t)) \\
    \Rightarrow K(t) &= K_0 - \int_{0}^{t} \left.\frac{\mathrm{d}}{\mathrm{d}s}\right|_{s=t} \Pi_{X(s)}(K(\tau))\,\mathrm{d}\tau \\
    &= K_0 - \left.\frac{\mathrm{d}}{\mathrm{d}s}\right|_{s=t} \Pi_{X(s)}\left( \int_{0}^{t} K(\tau) \,\mathrm{d}\tau \right) \\
    &=
\end{aligned}
$$
</p>