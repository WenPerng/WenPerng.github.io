---
title: 'Paper review: Geodesics of Stiefel Manifold (II)'
date: 2025-08-28
permalink: /posts/2025/08/blog-post-8/
tags:
  - manifold optimization
  - geometry
excerpt: "This post expands on the other formulations of the geodesics on the Stiefel manifold given in the [last post](/posts/2025/08/blog-post-4/). I go over the results and the references to which the results are stated and proven. But for now, I will not dig into the details."
---

In the [last post](/posts/2025/08/blog-post-4/), we derived the geodesics on the Stiefel manifold equipped with the Frobenius norm. The result references the work by [Edelman et al.](https://arxiv.org/abs/physics/9806030). But the form given there is not the whole story, in fact, there is more to it than it meets the eye.

For those who are interested in the details and an overview, the work "[Computing the Riemannian Logarithm on the Stiefel Manifold: Metrics, Methods and Performance](https://arxiv.org/abs/2103.12046)" by Zimmermann and Hüper is a good place to start.

# Other forms of geodesic solution
Besides writing the geodesic originating at \\(X\in\mathrm{St}(m,k)\\) with tangential velocity \\(H \in T_X\mathrm{St}(m,k)\\) as
<p>
$$
\boxed{\begin{equation*}
	\Gamma_{X,H}(t) = \left[\begin{matrix}
		X & H
	\end{matrix}\right] \cdot \exp\left(t \left[\begin{matrix}
		X^{\mathsf{T}}H & -H^{\mathsf{T}}H \\
		\mathbb{I}_k & X^{\mathsf{T}}H
	\end{matrix}\right]\right) \cdot \mathbb{I}_{2k,k} \cdot \exp\left(-tX^{\mathsf{T}}H\right)
\end{equation*}},
$$
</p>
two other forms are also common.

The second form is
<p>
$$
\boxed{\begin{equation*}
	\Gamma_{X,H}(t) = \overline{X} \cdot \exp\left(t \left[\begin{matrix}
		2X^{\mathsf{T}} H & -H^{\mathsf{T}} X_{\perp} \\
		X_{\perp}^{\mathsf{T}} H & 0
	\end{matrix}\right]\right) \cdot \mathbb{I}_{m,k} \cdot \exp\left(-tX^{\mathsf{T}}H\right)
\end{equation*}},
$$
</p>
where \\(\overline{X} = [X, X_{\perp}]\\) is an orthogonal matrix. To obtain this second form from the first, one simply observe that: If the tangential velocity is written as \\(H = X\Omega + X_{\perp}Z\\) with \\(\Omega\\) being skew-symmetric, then
<p>
$$
\left[\begin{matrix}
    X & H
\end{matrix}\right] = \left[\begin{matrix}
    X & X_\perp
\end{matrix}\right] \left[\begin{matrix}
    \mathbb{I} & \Omega \\ 0 & Z
\end{matrix}\right]
$$
</p>
and
<p>
$$
\left[\begin{matrix}
    \mathbb{I} & \Omega \\ 0 & Z
\end{matrix}\right] \left[\begin{matrix}
    X^{\mathsf{T}} H & -H^{\mathsf{T}} H \\ \mathbb{I} & X^{\mathsf{T}} H
\end{matrix}\right] = \left[\begin{matrix}
    2X^{\mathsf{T} H} & -H^{\mathsf{T}} X_{\perp} \\ X_{\perp}^{\mathsf{T}} H & 0
\end{matrix}\right] \left[\begin{matrix}
    \mathbb{I} & \Omega \\ 0 & Z
\end{matrix}\right]
$$
</p>
holds. The relation between the two equations then trivially follows.

The third form to the geodesic is
<p>
$$
\boxed{\begin{equation*}
	\Gamma_{X,H}(t) = \exp\left(t \left(HX^{\mathsf{T}} - XH^{\mathsf{T}}\right)\right) \cdot X \cdot \exp\left(-tX^{\mathsf{T}}H\right)
\end{equation*}}.
$$
</p>
From this form, we can also obtain the first derivative, second derivative, and parallel transport as
<p>
$$
\boxed{\begin{align*}
	\dot{\Gamma}_{X,H}(t) &= \exp\left(t \left(HX^{\mathsf{T}} - XH^{\mathsf{T}}\right)\right) \cdot H \cdot \exp\left(-tX^{\mathsf{T}}H\right), \\
    \ddot{\Gamma}_{X,H}(t) &= \exp\left(t \left(HX^{\mathsf{T}} - XH^{\mathsf{T}}\right)\right) \cdot (-XH^{\mathsf{T}}X) \cdot \exp\left(-tX^{\mathsf{T}}H\right), \\
    \tau_{\Gamma_{X,H}(t)}[K] &= \exp\left(t \left(HX^{\mathsf{T}} - XH^{\mathsf{T}}\right)\right) \cdot K \cdot \exp\left(-tX^{\mathsf{T}}H\right).
\end{align*}}.
$$
</p>
The parallel transport of a tangent vector \\(K \in T_X\mathrm{St}(m,k)\\) to another tangent vector \\(K \in T_{\Gamma_{X,H}(t)}\mathrm{St}(m,k)\\) is denoted by \\(\tau_{\Gamma_{X,H}(t)}[K]\\). It is defined as the solution \\(\tau(t)\\) to the differential equation
<p>
$$
\nabla_{\dot{\Gamma}_{X,H}(t)} \tau = 0.
$$
</p>
Luckily, since we already have the equation to the geodesic, the parallel transport can easily be derived as
<p>
$$
\tau_{\Gamma_{X,H}(t)}[K] = \left.\frac{\mathrm{d}}{\mathrm{d}s}\right|_{s=0}\Gamma_{X,H+sK}(t).
$$
</p>

One can notice that the three boxed equations are all very much similar, with the only difference being changing the term at the middle, which is their values when evaluated at \\(t=0\\). The left and right multiplication by the two exponentials seem to transport the term in the middle across the Stiefel manifold along a geodesic.

This third form can be obtained from the second by noticing that
<p>
$$
\overline{X} \cdot \exp\left(t \left[\begin{matrix}
		2X^{\mathsf{T}} H & -H^{\mathsf{T}} X_{\perp} \\
		X_{\perp}^{\mathsf{T}} H & 0
	\end{matrix}\right]\right) \cdot \overline{X}^{\mathsf{T}} = \exp\left(t(HX^{\mathsf{T}} - XH^\mathsf{T})\right).
$$
</p>

Of course, these so-called "derivation" of mine proposed above actually gives no further insight as to *why* they are written so. The works from which these are first proposed are organized in "[Computing the Riemannian Logarithm on the Stiefel Manifold: Metrics, Methods and Performance](https://arxiv.org/abs/2103.12046)." For example, the third form is derived in "[Real Stiefel Manifolds: An Extrinsic Point of View](https://ieeexplore.ieee.org/abstract/document/8514292)" by Hüper and Ullrich. I'll perhaps go over these recent[^1] works in the future.

[^1]: Yes, 2018 is really recent in these areas of research as of when I wrote this post, which is 2025.

Which formula is the best? Well, for aesthetics, I will definitely choose the third one as its formula is the simplest. However, if \\(m\gg 2k\\), the first formula is way faster for computation. This is especially important when working on an optimization of a large system.

# The canonical metric and the \\(\alpha\\)-metric
A geodesic is determined by the connection chosen. And if we choose the connection to be the unique Levi-Civita (Riemannian) connection associated with a metric, the geodesic is then determined by the metric used.

In the [previous post]((/posts/2025/08/blog-post-4/)), we only considered the Forbenius inner product of the form: for \\(H_1,H_2\in T_X\mathrm{St}(m,k)\\),
<p>
$$
g_{e}(H_1,H_2) = \langle H_1,H_2 \rangle_F = \mathrm{Tr}\left\{H_1^\mathsf{T} H_2\right\}.
$$
</p>
The symbol \\(g\\) is the metric, the inner product used -- or in a fancier differential geometrical term: the *first fundamental form* of the manifold. The subscript \\(e\\) denotes it is derived from the ambient Euclidean metric.

However, as pointed out in the work by Edelman, this norm treats the degrees of freedom on the tangent space with unequal weightings: let \\(H = X\Omega + X_{\perp}Z\\), then
<p>
$$
g_e(H,H) = \mathrm{Tr}\left\{\Omega^{\mathsf{T}} \Omega + Z^{\mathsf{T}} Z\right\} = 2 \sum_{i<j} \Omega_{ij} + \sum_{i,j} Z_{ij}.
$$
</p>
The degrees of freedom in \\(\Omega\\) have double the weights as those in the matrix \\(Z\\).

For this reason, the *canonical metric* is introduced:
<p>
$$
g_{c}(H,H) = \mathrm{Tr}\left\{H^\mathsf{T} \left(\mathbb{I} - \frac{1}{2} XX^{\mathsf{T}}\right) H\right\} = \frac{1}{2} \mathrm{Tr}\left\{\Omega^{\mathsf{T}} \Omega\right\} + \mathrm{Tr}\left\{Z^{\mathsf{T}} Z\right\}.
$$
</p>
giving equal weightings to all degrees of freedom. As this metric satisfies the parallelogram law, we can use the polarization identity to convert it into an inner product.

This metric in turn induces a different (but a simpler!) formula for the geodesic.

In the work "[A Lagrangian approach to extremal curves on Stiefel manifolds](https://www.researchgate.net/publication/347034260_A_Lagrangian_approach_to_extremal_curves_on_Stiefel_manifolds)", they even considered a one-parameter family of inner products of the form
<p>
$$
g_{\alpha}(H_1,H_2) = \frac{1}{2(\alpha+1)} \mathrm{Tr}\left\{\Omega_1^{\mathsf{T}} \Omega_2\right\} + \mathrm{Tr}\left\{Z_1^{\mathsf{T}} Z_2\right\}.
$$
</p>
If \\(\alpha = -0.5\\), this is the Euclidean metric; while if \\(\alpha = 0\\), this is the canonical metric.

For the \\(\alpha\\)-metric \\(g_\alpha\\), the induced geodesic is
<p>

$$
\boxed{\begin{equation*}
	\Gamma_{X,H}(t) = \exp\left(t \left(-\frac{2\alpha + 1}{\alpha + 1} XX^{\mathsf{T}}HX^{\mathsf{T}} + HX^{\mathsf{T}} - XH^{\mathsf{T}}\right)\right) \cdot X \cdot \exp\left(t\cdot \frac{\alpha}{\alpha+1}X^{\mathsf{T}}H\right)
\end{equation*}}.
$$
</p>
Crazy formula, right? To know all the secrets and geometry (besides the boring algebra) lurking within, one should definitely read the papers above. But that's all for today. Ciao.