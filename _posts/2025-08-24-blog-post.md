---
title: 'Paper review: Geodesics on Stiefel Manifold'
date: 2025-08-24
permalink: /posts/2025/08/blog-post-4/
tags:
  - manifold optimization
  - geometry
excerpt: "This post is a review on the paper \"[The Geoemtry of Algorithms with Orthogonality Constraints](https://arxiv.org/abs/physics/9806030)\" by Edelman et al. The focus of this review is on deriving the geodesics on the Stiefel manifold."
---

This post is a review on the paper "[The Geoemtry of Algorithms with Orthogonality Constraints](https://arxiv.org/abs/physics/9806030)" by Edelman et al. The focus of this review is on deriving the geodesics on the Stiefel manifold.

I have always wanted to know how the geodesics equation to the Stiefel manifold is obtained since I took the course "Manifold Optimization for Representation Learning" from professor [Hao Shen](https://www.researchgate.net/profile/Hao-Shen-15) from the Technische Universität München, 2024.

Thanks to a friend of mine (郭庭愷) who introduced me to this paper, I am finally able to understand the details.

# Basics on the Geometry of the Stiefel Manifold
Most of this section is established in my talk on [manifold optimization, 2024](/talks/2024-10-01-talk). If you are not sure of the details, be sure to check the slides there.

## Definition
The Stiefel manifold is a generalization to the orthogonal matrices, defined as
<p>
$$
\begin{equation}
	\mathrm{St}(m,k) = \left\{ X \in \mathbb{R}^{m \times k} \middle\vert X^{\mathsf{T}} X = \mathbb{I}_k\right\},
\end{equation}
$$
</p>
where \\(m\ge k\\) and \\(\mathbb{I}_k\\) is the \\(k \times k\\) identity matrix. Its dimension is
<p>
$$ \dim\left( \mathrm{St}(m,k) \right) = mk - \frac{k(k+1)}{2}.$$
</p>
This is easily obtained from the regular value level set theorem[^1].

[^1]: See: Tu, Loring W., "An introduction to manifolds." (2007).

## Tangent space
The tangent space to the Stiefel manifold at \\(X \in \mathrm{St}(m,k)\\) is
<p>
$$
\begin{equation}\begin{aligned}
	T_{X} \mathrm{St}(m,k) &= \left\{ H \in \mathbb{R}^{m \times k} \middle\vert H^{\mathsf{T}} X + X^{\mathsf{T}} H = 0 \right\} \\
	&= \left\{ X \Omega + X^{\perp} Z \middle\vert \Omega \in \mathrm{Skew}(k), Z \in \mathbb{R}^{(m-k) \times k} \right\},
\end{aligned}\end{equation}
$$
</p>
where \\(X^{\perp} \in \mathbb{R}^{m \times (m-k)}\\) is the orthogonal complement to \\(X\\) such that their column vectors form a basis of \\(\mathbb{R}^{m}\\) and \\(X^{\mathsf{T}} X^{\perp} = 0\\).

The orthogonal projection from \\(\mathbb{R}^{m \times k}\\) onto \\(T_{X} \mathrm{St}(m,k)\\) is
<p>
$$
\begin{equation}\begin{aligned}
	\Pi_X(H)
	&= H - X \cdot \mathrm{sym}\left(X^{\mathsf{T}} H\right) \\
	&= X \cdot \mathrm{skew}\left(X^{\mathsf{T}} H\right) + \left(\mathbb{I}_{m} - XX^{\mathsf{T}}\right) H.
\end{aligned}\end{equation}
$$
</p>

<details>
	<summary>In the paper, a really nice derivation of the orthogonal projection is given, without invoking the regular value theorem. Hence I provide it here in details.</summary>

	Consider the metric of the Stiefel manifold being induced from the Frobenius inner product from the ambiant space. The normal space to the tangent space \(T_{X} \mathrm{St}(m,k)\) consists of matrices \(N\) that satisfies
	<p>
	$$
	\langle H, N\rangle = \mathrm{Tr}\left\{ H^{\mathsf{T}} N\right\} = 0
	$$
	</p>
	for all tangent vectors \(H \in T_{X} \mathrm{St}(m,k)\).
</details>

# Geodesic equation
This paper by Edelman et al. focuses at optimization over the orthogonally constrained sets of Stiefel manifolds or the Grassmanian manifolds. In manifold optimization, it is crucial to obtain the geodesics on the manifold so as to obtain second order or higher order derivatives. These are the main motivations of this work.

In differential geometry, the geodesics is defined with respect to a connection \\(\nabla\\) on the manifold. For our case, we consider the unique *Levi-Civita connection* induced by the Frobenius inner product on matrices: \\(\langle X,Y\rangle = \mathrm{Tr}\\\{X^{\mathsf{T}} Y\\\}\\).


# Solving the geodesic equation