---
title: 'Paper review: The Geoemtry of Algorithms with Orthogonality Constraints (I)'
date: 2025-08-24
permalink: /posts/2025/08/blog-post-4/
tags:
  - manifold optimization
  - geometry
excerpt: "This post is a review on the paper \"[The Geoemtry of Algorithms with Orthogonality Constraints](https://arxiv.org/abs/physics/9806030)\" by Edelman et al. The focus of this review is on deriving the geodesics on the Stiefel manifold with respect to the Frobenius inner product."
---

This post is a review on the paper "[The Geoemtry of Algorithms with Orthogonality Constraints](https://arxiv.org/abs/physics/9806030)" by Edelman et al. This is a lengthy paper. The goal of this review is not to go through the entire paper, but to focus on deriving the explicit form of geodesics on the Stiefel manifold with respect to the Frobenius inner product. The other interesting aspects to this paper is shared in future posts.

I have always wanted to know how the geodesics equation to the Stiefel manifold is obtained since I took the course "Manifold Optimization for Representation Learning" from professor [Hao Shen](https://www.researchgate.net/profile/Hao-Shen-15) from the Technische Universität München, 2024.

Thanks to a friend of mine (郭庭愷) who introduced me to this paper, I am finally able to understand the details.

# Basics on the Geometry of the Stiefel Manifold
Most of this section is established in my talk on [manifold optimization, 2024](/talks/2024-10-01-talk). If you are not sure of the details, be sure to check the slides.

<br><img src='/images/talk/2024-10-01-manifold.png'>

## Definition
The Stiefel manifold is a generalization to the orthogonal matrices, defined as
<p>
$$
\boxed{\begin{equation*}
	\mathrm{St}(m,k) = \left\{ X \in \mathbb{R}^{m \times k} \middle\vert X^{\mathsf{T}} X = \mathbb{I}_k\right\},
\end{equation*}}
$$
</p>
where \\(m\ge k\\) and \\(\mathbb{I}_k\\) is the \\(k \times k\\) identity matrix. Its dimension is
<p>
$$ \dim\left( \mathrm{St}(m,k) \right) = mk - \frac{k(k+1)}{2}.$$
</p>
This is easily obtained from the regular value level set theorem[^1].

[^1]: See: Tu, Loring W., "An introduction to manifolds." (2007).

## Tangent space
The tangent space to the Stiefel manifold at \\(X \in \mathrm{St}(m,k)\\) is
<p>
$$
\boxed{\begin{equation}\begin{aligned}
	T_{X} \mathrm{St}(m,k) &= \left\{ H \in \mathbb{R}^{m \times k} \middle\vert H^{\mathsf{T}} X + X^{\mathsf{T}} H = 0 \right\} \\
	&= \left\{ X \Omega + X^{\perp} Z \middle\vert \Omega \in \mathrm{Skew}(k), Z \in \mathbb{R}^{(m-k) \times k} \right\},
\end{aligned}\end{equation}}
$$
</p>
where \\(X^{\perp} \in \mathbb{R}^{m \times (m-k)}\\) is the orthogonal complement to \\(X\\) such that their column vectors form a basis of \\(\mathbb{R}^{m}\\) and \\(X^{\mathsf{T}} X^{\perp} = 0\\).

The orthogonal projection from \\(\mathbb{R}^{m \times k}\\) onto \\(T_{X} \mathrm{St}(m,k)\\) with respect to the Frobenius inner product \\(\langle X,Y\rangle = \mathrm{Tr}\\\{X^{\mathsf{T}} Y\\\}\\) is
<p>
$$
\boxed{\begin{equation}\begin{aligned}
	\Pi_X(H)
	&= H - X \cdot \mathrm{sym}\left(X^{\mathsf{T}} H\right) \\
	&= X \cdot \mathrm{skew}\left(X^{\mathsf{T}} H\right) + \left(\mathbb{I}_{m} - XX^{\mathsf{T}}\right) H.
\end{aligned}\end{equation}}
$$
</p>

<details>
	<summary>In the paper, a really nice derivation of the orthogonal projection is given, without invoking the regular value theorem. Hence I provide it here in details.</summary>

	Consider the metric of the Stiefel manifold being induced from the Frobenius inner product from the ambiant space. The normal space to the tangent space \(T_{X} \mathrm{St}(m,k)\) is denoted by \((T_{X} \mathrm{St}(m,k))^{\perp}\), consisting of matrices \(N\) that satisfies
	<p>
	$$
	\langle H, N\rangle = \mathrm{Tr}\left\{ H^{\mathsf{T}} N\right\} = 0
	$$
	</p>
	for all tangent vectors \(H \in T_{X} \mathrm{St}(m,k)\). From the second description of the tangent space, by assuming \(N = XS + X^{\perp} Z\) we can deduce that \(Z=0\) and \(S\) is symmetric. I.e., the normal space at \(X\) must be of the form
	$$
		\left\{ N \in \mathbb{R}^{m\times k} \middle\vert N = XS, S\text{ is symmetric} \right\}.
	$$
	Since we have the unique decomposition \(\mathbb{R}^{m \times k} = T_{X} \mathrm{St}(m,k) \oplus (T_{X} \mathrm{St}(m,k))^\perp\), there exists unique matrices \(\Omega\) (skew-symmetric), \(Z\), and \(S\) (symmetric) that satisfy
	$$
		H = X \Omega + X^{\perp} Z + XS.
	$$
	Henceforth, we obtain \(S = \mathrm{sym}(X^{\mathsf{T}} H)\), and
	$$
		\Pi_X(H) = H - XS = H - X \cdot \mathrm{sym}(X^{\mathsf{T}} H). \;\;\;\;\; \blacksquare
	$$
</details>

<br>

# Geodesic equation
This paper by Edelman et al. focuses at optimization over the orthogonally constrained sets of Stiefel manifolds or the Grassmanian manifolds. In manifold optimization, it is crucial to obtain the geodesics on the manifold so as to obtain second order or higher order derivatives. These are the main motivations of this work.

In differential geometry, the geodesics is defined with respect to a connection \\(\nabla\\) on the manifold. For our case, we consider the unique *Levi-Civita connection* induced by the Frobenius inner product.

Let \\(X(t)\\) be the geodesic curve on \\(\mathrm{St}(m,k)\\), its covariant derivative is zero with respect to itself. That it to say, it is of constant velocity on the manifold:
<p>
$$
\nabla_{\dot{X}} \dot{X} = 0.
$$
</p>
Since we consider the Stiefel manifold to be embedded within \\(\mathbb{R}^{m \times k}\\), we can equivalently say that the acceleration of the geodesic must be in the normal direction:
<p>
$$\begin{align*}
&\nabla_{\dot{X}} \dot{X} = \left(\ddot{X}\right)_{\mathrm{tangent}}= 0 \\
&\Rightarrow \ddot{X} \in \left(T_{X}\mathrm{St}(m,k)\right)^{\perp} \\
&\Rightarrow \ddot{X}(t) = X(t) S(t),
\end{align*}$$
</p>
where \\(S\\) is a symmetric matrix that depends on \\(t\\) as well. Furthermore, since \\(X^{\mathsf{T}}(t) X(t) = \mathbb{I}_m\\) for all \\(t\\),
<p>
$$
\begin{align*}
	&\frac{\mathrm{d}^2}{\mathrm{d}t^2} X^{\mathsf{T}} X = \ddot{X}^{\mathsf{T}} X + 2 \dot{X}^{\mathsf{T}} \dot{X} + X \ddot{X}^{\mathsf{T}} = 0 \\
	&\Rightarrow S X^{\mathsf{T}} X + 2 \dot{X}^{\mathsf{T}} \dot{X} + X^{\mathsf{T}} X S = 0 \\
	&\Rightarrow S = - \dot{X}^{\mathsf{T}} \dot{X}.
\end{align*}
$$
</p>
We have thus obtained the geodesic equation on the Stiefel manifold:
<p>
$$
\boxed{
	\ddot{X} + X \dot{X}^{\mathsf{T}} \dot{X} = 0
}.
$$
</p>
It should be noted that unlike in differential geometry, we like to express our equations under an extrinsic coordinate (\\(\mathbb{R}^{m \times k}\\)) when analyzing the geometry of a matrix manifold. The expressions beomce clean and coordinate-free.

# Solving the geodesic equation
Let us solve the geodesic equation! Instead of just giving you the answer and spoiling the fun, we will derive the solution from the geodesic equation step by step. Let us first state our initial conditions: we will be deriving a geodesic emanating from \\(X \in \mathrm{St}(m,k)\\) in the direction of \\(H \in T_X \mathrm{St}(m,k)\\).

Within the paper, they solved the geodesic equations by noticing the invariants of motion. From these invariants, and from a stoke of genius (a humble "observation" is the word they used) by Ross Lippert, they reduced the second-order geodesic equation into a first-order differential equation that is easily solvable. The two invariants are
\\(X^{\mathsf{T}}(t)X(t) = \mathbb{I}\\) and \\(X^{\mathsf{T}}(t)\dot{X}(t) = A \\). The first one is trivial, and the second is obtained by fiddling around with the geodesic equation:
<p>
$$
\begin{align*}
	0 &= \ddot{X} + X \dot{X}^{\mathsf{T}} \dot{X} \\
	\Rightarrow 0 &= X^{\mathsf{T}} \ddot{X} + \dot{X}^{\mathsf{T}} \dot{X} \\
	&= \frac{\mathrm{d}}{\mathrm{d}t} X^{\mathsf{T}} \dot{X}.
\end{align*}
$$
</p>

A different approach is given here. Let me introduce the usual (column-wise) vectorization of a matrix as stacking each column of \\(X\\) into a column vector denoted by \\(\mathrm{vec}(X)\\). The vectorization operation has a lot of usages worth discussing in future posts, but for the time being, I'm using the following result:
<p>
$$
	\mathrm{vec}(AXB) = \left(B^{\mathsf{T}} \otimes A\right) \mathrm{vec}(X),
$$
</p>
where \\(\otimes\\) is the Kronecker product. Using vectorization, the geodesic equation can be transformed into a first-order differential equation using the state space method:

$$
\begin{align*}
	\frac{\mathrm{d}}{\mathrm{d}t} \left[\begin{matrix}
		\mathrm{vec}(X) \\ \mathrm{vec}(\dot{X})
	\end{matrix}\right] &= \left[\begin{matrix}
		\mathrm{vec}(\dot{X}) \\ \mathrm{vec}(\ddot{X})
	\end{matrix}\right] = \left[\begin{matrix}
		\mathrm{vec}(\dot{X}) \\ \mathrm{vec}(-X \dot{X}^{\mathsf{T}} \dot{X})
	\end{matrix}\right] \\
	&= \left[\begin{matrix}
		\mathrm{vec}(\dot{X}) \\ \mathrm{vec}(\ddot{X})
	\end{matrix}\right]
\end{align*}
$$

